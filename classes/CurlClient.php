<?php
interface ClientInterface{function get($a,array $b=array());function post($a,array $b=array());function put($a,array $b=array());function delete($a,array $b=array());}class CurlClient implements ClientInterface{protected $c=null;protected $d=0;protected $e=2;function __construct($f=1){$this->timeOutConnect=$f;$this->initializeCurl();}function setAuthenDigest($h,$i){curl_setopt($this->curl,CURLOPT_USERPWD,$h.":".$i);curl_setopt($this->curl,CURLOPT_HTTPAUTH,CURLAUTH_DIGEST);}public function get($a,array $b=array()){curl_setopt($this->curl,CURLOPT_CUSTOMREQUEST,'GET');curl_setopt($this->curl,CURLOPT_URL,sprintf("%s?%s",$a,http_build_query($b)));$b=debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS);return $this->fetch($b);}public function post($a,array $b=array()){curl_setopt($this->curl,CURLOPT_CUSTOMREQUEST,'POST');curl_setopt($this->curl,CURLOPT_URL,$a);curl_setopt($this->curl,CURLOPT_POSTFIELDS,$b);$b=debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS);return $this->fetch($b);}public function put($a,array $b=array()){curl_setopt($this->curl,CURLOPT_CUSTOMREQUEST,'PUT');}public function delete($a,array $b=array()){curl_setopt($this->curl,CURLOPT_URL,sprintf("%s?%s",$a,http_build_query($b)));curl_setopt($this->curl,CURLOPT_CUSTOMREQUEST,'DELETE');$b=debug_backtrace(DEBUG_BACKTRACE_IGNORE_ARGS);return $this->fetch($b);}protected function initializeCurl(){$this->start_generate_time=MyLog::microtime_float();$this->curl=curl_init();curl_setopt($this->curl,CURLOPT_RETURNTRANSFER,true);curl_setopt($this->curl,CURLOPT_SSL_VERIFYPEER,false);curl_setopt($this->curl,CURLOPT_TIMEOUT,$this->timeOutConnect);curl_setopt($this->curl,CURLOPT_FOLLOWLOCATION,true);}protected function fetch($j){$k=curl_exec($this->curl);$l=curl_error($this->curl);$m=curl_getinfo($this->curl,CURLINFO_HTTP_CODE);$j[0]["code"]=$m;if($l){MyLog::checkLogError($l,"curl",$j);}$n=MyLog::microtime_float()-$this->start_generate_time;$this->start_generate_time=MyLog::microtime_float();MyLog::checkLogSlow($n,"curl",$j);return $k;}}